<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio Monitor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;500;600;700&family=SF+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'ios': {
                            'bg': '#000000',
                            'surface': '#1c1c1e',
                            'elevated': '#2c2c2e',
                            'separator': 'rgba(84, 84, 88, 0.65)',
                        },
                        'glass': {
                            'bg': 'rgba(255, 255, 255, 0.05)',
                            'border': 'rgba(255, 255, 255, 0.08)',
                            'hover': 'rgba(255, 255, 255, 0.08)',
                        },
                        'accent': '#007AFF',
                        'profit': '#34C759',
                        'loss': '#FF3B30',
                        'text': {
                            'primary': '#ffffff',
                            'secondary': '#ebebf5',
                            'tertiary': '#ebebf599',
                            'muted': '#8e8e93',
                        }
                    },
                    fontFamily: {
                        'sans': ['-apple-system', 'BlinkMacSystemFont', 'SF Pro Display', 'Helvetica Neue', 'Arial', 'sans-serif'],
                        'mono': ['SF Mono', 'Monaco', 'Menlo', 'monospace'],
                    },
                }
            }
        }
    </script>
    <style>
        /* iOS æ·±è‰²èƒŒæ™¯ */
        body {
            background: #000000;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* æŸ”å’Œçš„èƒŒæ™¯å…‰æ™• - Apple é£æ ¼ */
        .bg-glow {
            position: fixed;
            border-radius: 50%;
            filter: blur(120px);
            pointer-events: none;
            z-index: 0;
        }

        .bg-glow-1 {
            width: 800px;
            height: 800px;
            background: radial-gradient(circle, rgba(0, 122, 255, 0.08) 0%, transparent 70%);
            top: -300px;
            right: -200px;
            animation: drift 30s ease-in-out infinite;
        }

        .bg-glow-2 {
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, rgba(88, 86, 214, 0.06) 0%, transparent 70%);
            bottom: -200px;
            left: -150px;
            animation: drift 35s ease-in-out infinite reverse;
        }

        .bg-glow-3 {
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(175, 82, 222, 0.05) 0%, transparent 70%);
            top: 40%;
            left: 30%;
            animation: drift 40s ease-in-out infinite;
        }

        @keyframes drift {
            0%, 100% { transform: translate(0, 0); }
            25% { transform: translate(30px, -20px); }
            50% { transform: translate(-15px, 25px); }
            75% { transform: translate(-25px, -15px); }
        }

        /* iOS ç»ç’ƒæ•ˆæœ */
        .glass {
            background: rgba(28, 28, 30, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 0.5px solid rgba(255, 255, 255, 0.08);
        }

        .glass-light {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 0.5px solid rgba(255, 255, 255, 0.1);
        }

        .glass-hover {
            transition: all 0.25s ease;
        }

        .glass-hover:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-1px);
        }

        /* iOS é£æ ¼æŒ‰é’® */
        .btn-ios {
            background: #007AFF;
            transition: all 0.2s ease;
        }

        .btn-ios:hover {
            background: #0066d6;
            transform: scale(0.98);
        }

        .btn-ios:active {
            transform: scale(0.96);
        }

        /* è„‰å†²æŒ‡ç¤ºå™¨ */
        .pulse-dot {
            animation: pulse-ios 2s ease-in-out infinite;
        }

        @keyframes pulse-ios {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        /* æ·¡å…¥åŠ¨ç”» */
        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* iOS é£æ ¼æ»šåŠ¨æ¡ */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.15); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(255, 255, 255, 0.25); }

        /* è¾“å…¥æ¡†æ ·å¼ */
        input[type="datetime-local"],
        select {
            color-scheme: dark;
        }

        /* è¡¨æ ¼è¡Œæ‚¬æµ® */
        .table-row-hover {
            transition: background-color 0.15s ease;
        }

        .table-row-hover:hover {
            background: rgba(255, 255, 255, 0.04);
        }

        /* è¡¨æ ¼æ–‘é©¬çº¹ */
        .table-row-hover:nth-child(odd) {
            background: rgba(255, 255, 255, 0.02);
        }

        .table-row-hover:nth-child(odd):hover {
            background: rgba(255, 255, 255, 0.05);
        }

        /* ç›ˆäºé«˜äº®èƒŒæ™¯ */
        .profit-highlight {
            background: rgba(52, 199, 89, 0.08);
        }

        .loss-highlight {
            background: rgba(255, 59, 48, 0.08);
        }

        /* æ…¢é€Ÿå¼¹è·³åŠ¨ç”» */
        .animate-bounce-slow {
            animation: bounce-slow 3s ease-in-out infinite;
        }

        @keyframes bounce-slow {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* iOS åˆ†éš”çº¿ */
        .ios-separator {
            border-color: rgba(84, 84, 88, 0.65);
        }

        /* æ ‡ç­¾æ¿€æ´»çŠ¶æ€ */
        .tab-active {
            background: #007AFF;
            color: white;
        }

        /* æŸ”å’Œçš„æ–‡å­—å‘å…‰ */
        .glow-profit { text-shadow: 0 0 20px rgba(52, 199, 89, 0.3); }
        .glow-loss { text-shadow: 0 0 20px rgba(255, 59, 48, 0.3); }

        /* æ‚¬æµ®è¯¦æƒ…æŒ‰é’® */
        .detail-btn {
            opacity: 0;
            transition: opacity 0.15s ease;
        }

        .position-card:hover .detail-btn,
        .asset-card:hover .detail-btn,
        .table-row-hover:hover .detail-btn {
            opacity: 1;
        }

        /* Modal æ ·å¼ */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, visibility 0.2s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.95);
            z-index: 101;
            width: 90%;
            max-width: 560px;
            max-height: 85vh;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, visibility 0.2s ease, transform 0.2s ease;
        }

        .modal-overlay.active + .modal-container,
        .modal-container.active {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }

        .modal-content {
            background: rgba(44, 44, 46, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 0.5px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            overflow: hidden;
        }

        .modal-header {
            padding: 20px 24px;
            border-bottom: 0.5px solid rgba(84, 84, 88, 0.65);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-body {
            padding: 20px 24px;
            max-height: calc(85vh - 80px);
            overflow-y: auto;
        }

        .modal-close {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.15s ease;
            cursor: pointer;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* å­—æ®µåˆ†ç»„ */
        .field-group {
            margin-bottom: 20px;
        }

        .field-group:last-child {
            margin-bottom: 0;
        }

        .field-group-title {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #8e8e93;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 0.5px solid rgba(84, 84, 88, 0.4);
        }

        .field-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 8px 0;
        }

        .field-row:not(:last-child) {
            border-bottom: 0.5px solid rgba(84, 84, 88, 0.3);
        }

        .field-key {
            font-size: 13px;
            color: #8e8e93;
            flex-shrink: 0;
            margin-right: 16px;
        }

        .field-value {
            font-size: 13px;
            color: #ebebf5;
            font-family: 'SF Mono', Monaco, monospace;
            text-align: right;
            word-break: break-all;
        }

        .field-value.profit { color: #34C759; }
        .field-value.loss { color: #FF3B30; }
        .field-value.muted { color: #8e8e93; }
    </style>
</head>
<body class="font-sans text-text-primary">
    <!-- èƒŒæ™¯å…‰æ™• -->
    <div class="bg-glow bg-glow-1"></div>
    <div class="bg-glow bg-glow-2"></div>
    <div class="bg-glow bg-glow-3"></div>

    <div id="app" class="relative z-10 flex h-screen">
        <!-- ä¾§è¾¹æ  -->
        <aside class="w-72 glass flex flex-col">
            <!-- Logo -->
            <div class="p-6 border-b ios-separator">
                <h1 class="text-xl font-semibold text-text-primary">Portfolio Monitor</h1>
                <p class="text-xs text-text-muted mt-2 flex items-center gap-2">
                    <span class="w-1.5 h-1.5 rounded-full bg-accent"></span>
                    å¤šè´¦æˆ·å®æ—¶ç›‘æ§
                </p>
            </div>

            <!-- è¿æ¥çŠ¶æ€ -->
            <div class="px-6 py-4 border-b ios-separator flex items-center gap-3">
                <span id="ws-status" class="w-2 h-2 rounded-full bg-loss pulse-dot"></span>
                <span id="ws-status-text" class="text-sm text-text-muted">è¿æ¥ä¸­...</span>
            </div>

            <!-- æ±‡æ€»ä¿¡æ¯ -->
            <div class="p-6 border-b ios-separator">
                <div class="text-xs text-text-muted uppercase tracking-wide mb-2">æ€»èµ„äº§ (USDT)</div>
                <div id="total-equity" class="text-3xl font-semibold text-text-primary font-mono">--</div>
                <div class="flex items-center gap-3 mt-4">
                    <span class="text-xs text-text-muted">æœªå®ç°ç›ˆäº</span>
                    <span id="total-pnl" class="text-sm font-mono font-medium">--</span>
                </div>
            </div>

            <!-- è´¦æˆ·åˆ—è¡¨ -->
            <div class="flex-1 overflow-y-auto p-4">
                <div class="text-xs text-text-muted uppercase tracking-wide px-3 py-2 mb-2">è´¦æˆ·åˆ—è¡¨</div>
                <div id="account-list" class="space-y-1">
                    <!-- åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>

            <!-- åˆ·æ–°æŒ‰é’® -->
            <div class="p-4 border-t ios-separator">
                <button onclick="refreshData()" class="w-full py-3 px-4 btn-ios rounded-xl text-sm font-medium text-white">
                    åˆ·æ–°æ•°æ®
                </button>
            </div>
        </aside>

        <!-- ä¸»å†…å®¹åŒº -->
        <main class="flex-1 overflow-hidden flex flex-col">
            <!-- é¡¶éƒ¨æ ‡ç­¾æ  -->
            <div class="glass border-b ios-separator px-6 py-4 flex items-center gap-2">
                <button onclick="switchTab('positions')" id="tab-positions" class="tab-btn px-5 py-2 rounded-lg text-sm font-medium tab-active transition-all">
                    ä»“ä½
                </button>
                <button onclick="switchTab('assets')" id="tab-assets" class="tab-btn px-5 py-2 rounded-lg text-sm font-medium text-text-muted hover:text-text-primary hover:bg-glass-hover transition-all">
                    èµ„äº§
                </button>
                <button onclick="switchTab('pending-orders')" id="tab-pending-orders" class="tab-btn px-5 py-2 rounded-lg text-sm font-medium text-text-muted hover:text-text-primary hover:bg-glass-hover transition-all">
                    åœ¨é€”è®¢å•
                </button>
                <button onclick="switchTab('orders')" id="tab-orders" class="tab-btn px-5 py-2 rounded-lg text-sm font-medium text-text-muted hover:text-text-primary hover:bg-glass-hover transition-all">
                    å†å²è®¢å•
                </button>
                <button onclick="switchTab('bills')" id="tab-bills" class="tab-btn px-5 py-2 rounded-lg text-sm font-medium text-text-muted hover:text-text-primary hover:bg-glass-hover transition-all">
                    è´¦å•æµæ°´
                </button>
                <button onclick="switchTab('position-history')" id="tab-position-history" class="tab-btn px-5 py-2 rounded-lg text-sm font-medium text-text-muted hover:text-text-primary hover:bg-glass-hover transition-all">
                    å†å²ä»“ä½
                </button>
                <button onclick="switchTab('equity-curve')" id="tab-equity-curve" class="tab-btn px-5 py-2 rounded-lg text-sm font-medium text-text-muted hover:text-text-primary hover:bg-glass-hover transition-all">
                    èµ„äº§æ›²çº¿
                </button>
                <div class="flex-1"></div>
                <span id="current-account-name" class="text-sm text-text-muted px-4 py-2 glass-light rounded-lg">å…¨éƒ¨è´¦æˆ·</span>
            </div>

            <!-- å†…å®¹åŒºåŸŸ -->
            <div class="flex-1 overflow-auto p-6">
                <!-- ä»“ä½è§†å›¾ -->
                <div id="view-positions" class="space-y-5">
                    <!-- è´¦æˆ·èµ„äº§å¡ç‰‡ -->
                    <div id="balance-card" class="glass-light rounded-2xl p-6 glass-hover fade-in">
                        <h3 class="text-xs text-text-muted uppercase tracking-wide mb-5">è´¦æˆ·èµ„äº§</h3>
                        <div class="grid grid-cols-4 gap-6">
                            <div class="relative">
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="text-base">ğŸ’</span>
                                    <span class="text-xs text-text-muted">æ€»æƒç›Š</span>
                                </div>
                                <div id="account-equity" class="text-2xl font-mono font-semibold text-text-primary">--</div>
                            </div>
                            <div class="relative">
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="text-base">ğŸ’µ</span>
                                    <span class="text-xs text-text-muted">å¯ç”¨ä½™é¢</span>
                                </div>
                                <div id="account-available" class="text-2xl font-mono font-medium text-profit">--</div>
                            </div>
                            <div class="relative">
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="text-base">ğŸ”’</span>
                                    <span class="text-xs text-text-muted">å·²ç”¨ä¿è¯é‡‘</span>
                                </div>
                                <div id="account-margin" class="text-2xl font-mono font-medium text-text-secondary">--</div>
                                <!-- ä¿è¯é‡‘ä½¿ç”¨ç‡ -->
                                <div class="mt-2">
                                    <div class="h-1.5 bg-ios-elevated rounded-full overflow-hidden">
                                        <div id="margin-ratio-bar" class="h-full bg-accent rounded-full transition-all" style="width: 0%"></div>
                                    </div>
                                    <div id="margin-ratio-text" class="text-xs text-text-muted mt-1 font-mono">0%</div>
                                </div>
                            </div>
                            <div class="relative">
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="text-base">ğŸ“Š</span>
                                    <span class="text-xs text-text-muted">æœªå®ç°ç›ˆäº</span>
                                </div>
                                <div id="account-pnl" class="text-2xl font-mono font-semibold">--</div>
                            </div>
                        </div>
                    </div>

                    <!-- ä»“ä½å¡ç‰‡ -->
                    <div class="glass-light rounded-2xl overflow-hidden fade-in">
                        <div class="px-6 py-4 border-b ios-separator flex items-center justify-between">
                            <h3 class="text-xs text-text-muted uppercase tracking-wide">åˆçº¦ä»“ä½</h3>
                            <span id="position-count" class="text-xs text-text-muted px-3 py-1 bg-ios-elevated rounded-full">0 ä¸ªä»“ä½</span>
                        </div>
                        <div id="positions-container" class="p-4 grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4">
                            <!-- åŠ¨æ€ç”Ÿæˆå¡ç‰‡ -->
                        </div>
                        <div id="no-positions" class="hidden px-6 py-16 text-center text-text-muted text-sm">
                            <div class="text-5xl mb-4 opacity-40 animate-pulse">ğŸ“­</div>
                            <div class="text-base mb-1">æš‚æ— æŒä»“</div>
                            <div class="text-xs text-text-muted/60">å½“å‰æ²¡æœ‰æ´»è·ƒçš„åˆçº¦ä»“ä½</div>
                        </div>
                    </div>
                </div>

                <!-- èµ„äº§è§†å›¾ -->
                <div id="view-assets" class="hidden space-y-5">
                    <!-- èµ„äº§å¡ç‰‡ -->
                    <div class="glass-light rounded-2xl overflow-hidden fade-in">
                        <div class="px-6 py-4 border-b ios-separator flex items-center justify-between">
                            <h3 class="text-xs text-text-muted uppercase tracking-wide">å¸ç§èµ„äº§</h3>
                            <span id="asset-count" class="text-xs text-text-muted px-3 py-1 bg-ios-elevated rounded-full">0 ä¸ªå¸ç§</span>
                        </div>
                        <div id="assets-container" class="p-4 grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4">
                            <!-- åŠ¨æ€ç”Ÿæˆå¡ç‰‡ -->
                        </div>
                        <div id="no-assets" class="hidden px-6 py-16 text-center text-text-muted text-sm">
                            <div class="text-5xl mb-4 opacity-40 animate-bounce-slow">ğŸ’°</div>
                            <div class="text-base mb-1">æš‚æ— èµ„äº§</div>
                            <div class="text-xs text-text-muted/60">èµ„äº§æ•°æ®å°†åœ¨è¿æ¥åæ˜¾ç¤º</div>
                        </div>
                    </div>
                </div>

                <!-- åœ¨é€”è®¢å•è§†å›¾ -->
                <div id="view-pending-orders" class="hidden space-y-5">
                    <!-- åœ¨é€”è®¢å•è¡¨æ ¼ -->
                    <div class="glass-light rounded-2xl overflow-hidden fade-in">
                        <div class="px-6 py-4 border-b ios-separator flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <h3 class="text-xs text-text-muted uppercase tracking-wide">åœ¨é€”è®¢å•</h3>
                                <span id="pending-order-count" class="text-xs text-text-muted px-3 py-1 bg-ios-elevated rounded-full">0 ä¸ªæŒ‚å•</span>
                            </div>
                            <button onclick="loadPendingOrders()" class="px-4 py-1.5 bg-ios-elevated hover:bg-ios-surface rounded-lg text-xs font-medium transition-all flex items-center gap-2">
                                <span>åˆ·æ–°</span>
                            </button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="text-xs text-text-muted">
                                    <tr class="border-b ios-separator">
                                        <th class="text-left px-6 py-3.5 font-medium">æ—¶é—´</th>
                                        <th class="text-left px-6 py-3.5 font-medium">åˆçº¦</th>
                                        <th class="text-left px-6 py-3.5 font-medium">å¼€å¹³</th>
                                        <th class="text-left px-6 py-3.5 font-medium">ç±»å‹</th>
                                        <th class="text-right px-6 py-3.5 font-medium">å§”æ‰˜ä»·</th>
                                        <th class="text-right px-6 py-3.5 font-medium">å§”æ‰˜é‡</th>
                                        <th class="text-right px-6 py-3.5 font-medium">å·²æˆäº¤</th>
                                        <th class="text-right px-6 py-3.5 font-medium">æˆäº¤å‡ä»·</th>
                                        <th class="text-left px-6 py-3.5 font-medium">çŠ¶æ€</th>
                                    </tr>
                                </thead>
                                <tbody id="pending-orders-table">
                                    <!-- åŠ¨æ€ç”Ÿæˆ -->
                                </tbody>
                            </table>
                        </div>
                        <div id="no-pending-orders" class="hidden px-6 py-16 text-center text-text-muted text-sm">
                            <div class="text-5xl mb-4 opacity-40">âœ¨</div>
                            <div class="text-base mb-1">æš‚æ— åœ¨é€”è®¢å•</div>
                            <div class="text-xs text-text-muted/60">æ‰€æœ‰è®¢å•å·²æˆäº¤æˆ–å–æ¶ˆ</div>
                        </div>
                        <div id="pending-orders-loading" class="hidden px-6 py-16 text-center text-text-muted text-sm">
                            <div class="inline-block w-5 h-5 border-2 border-accent border-t-transparent rounded-full animate-spin mb-3"></div>
                            <div>åŠ è½½ä¸­...</div>
                        </div>
                    </div>
                </div>

                <!-- è®¢å•è§†å›¾ -->
                <div id="view-orders" class="hidden space-y-5">
                    <!-- æ—¶é—´ç­›é€‰ -->
                    <div class="glass-light rounded-2xl p-5 fade-in">
                        <div class="flex items-end gap-4">
                            <div>
                                <label class="text-xs text-text-muted block mb-2">å¼€å§‹æ—¶é—´</label>
                                <input type="datetime-local" id="order-start" class="bg-ios-elevated border-none rounded-xl px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all">
                            </div>
                            <div>
                                <label class="text-xs text-text-muted block mb-2">ç»“æŸæ—¶é—´</label>
                                <input type="datetime-local" id="order-end" class="bg-ios-elevated border-none rounded-xl px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all">
                            </div>
                            <button onclick="loadOrders()" class="px-6 py-2.5 btn-ios rounded-xl text-sm font-medium text-white">
                                æŸ¥è¯¢
                            </button>
                        </div>
                    </div>

                    <!-- è®¢å•è¡¨æ ¼ -->
                    <div class="glass-light rounded-2xl overflow-hidden fade-in">
                        <div class="px-6 py-4 border-b ios-separator flex items-center justify-between">
                            <h3 class="text-xs text-text-muted uppercase tracking-wide">å†å²è®¢å•</h3>
                            <!-- åˆ†é¡µæ§ä»¶ -->
                            <div id="orders-pagination" class="hidden flex items-center gap-2">
                                <button onclick="ordersPrevPage()" id="orders-prev-btn" class="px-3 py-1.5 bg-ios-elevated hover:bg-ios-surface rounded-lg text-xs font-medium disabled:opacity-40 disabled:cursor-not-allowed transition-all" disabled>
                                    ä¸Šä¸€é¡µ
                                </button>
                                <span id="orders-page-info" class="text-xs text-text-muted px-2">ç¬¬ 1 é¡µ</span>
                                <button onclick="ordersNextPage()" id="orders-next-btn" class="px-3 py-1.5 bg-ios-elevated hover:bg-ios-surface rounded-lg text-xs font-medium disabled:opacity-40 disabled:cursor-not-allowed transition-all" disabled>
                                    ä¸‹ä¸€é¡µ
                                </button>
                            </div>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="text-xs text-text-muted">
                                    <tr class="border-b ios-separator">
                                        <th class="text-left px-6 py-3.5 font-medium">æ—¶é—´</th>
                                        <th class="text-left px-6 py-3.5 font-medium">åˆçº¦</th>
                                        <th class="text-left px-6 py-3.5 font-medium">æ–¹å‘</th>
                                        <th class="text-left px-6 py-3.5 font-medium">ç±»å‹</th>
                                        <th class="text-right px-6 py-3.5 font-medium">æ•°é‡</th>
                                        <th class="text-right px-6 py-3.5 font-medium">æˆäº¤å‡ä»·</th>
                                        <th class="text-right px-6 py-3.5 font-medium">ç›ˆäº</th>
                                        <th class="text-right px-6 py-3.5 font-medium">æ‰‹ç»­è´¹</th>
                                        <th class="text-left px-6 py-3.5 font-medium">çŠ¶æ€</th>
                                    </tr>
                                </thead>
                                <tbody id="orders-table" class="divide-y divide-ios-separator">
                                    <!-- åŠ¨æ€ç”Ÿæˆ -->
                                </tbody>
                            </table>
                        </div>
                        <div id="no-orders" class="hidden px-6 py-16 text-center text-text-muted text-sm">
                            <div class="text-5xl mb-4 opacity-40">ğŸ“‹</div>
                            <div class="text-base mb-1">æš‚æ— è®¢å•è®°å½•</div>
                            <div class="text-xs text-text-muted/60">é€‰æ‹©æ—¶é—´èŒƒå›´æŸ¥è¯¢å†å²è®¢å•</div>
                        </div>
                        <div id="orders-loading" class="hidden px-6 py-16 text-center text-text-muted text-sm">
                            <div class="inline-block w-5 h-5 border-2 border-accent border-t-transparent rounded-full animate-spin mb-3"></div>
                            <div>åŠ è½½ä¸­...</div>
                        </div>
                    </div>
                </div>

                <!-- è´¦å•è§†å›¾ -->
                <div id="view-bills" class="hidden space-y-5">
                    <!-- ç­›é€‰æ¡ä»¶ -->
                    <div class="glass-light rounded-2xl p-5 fade-in">
                        <div class="flex items-end gap-4 flex-wrap">
                            <div>
                                <label class="text-xs text-text-muted block mb-2">è´¦å•ç±»å‹</label>
                                <select id="bill-type" class="bg-ios-elevated border-none rounded-xl px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all min-w-[120px]">
                                    <option value="">å…¨éƒ¨</option>
                                    <option value="2">äº¤æ˜“</option>
                                    <option value="8">èµ„é‡‘è´¹</option>
                                    <option value="1">åˆ’è½¬</option>
                                    <option value="5">å¼ºå¹³</option>
                                    <option value="4">å¼ºå‡</option>
                                </select>
                            </div>
                            <div>
                                <label class="text-xs text-text-muted block mb-2">å¼€å§‹æ—¶é—´</label>
                                <input type="datetime-local" id="bill-start" class="bg-ios-elevated border-none rounded-xl px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all">
                            </div>
                            <div>
                                <label class="text-xs text-text-muted block mb-2">ç»“æŸæ—¶é—´</label>
                                <input type="datetime-local" id="bill-end" class="bg-ios-elevated border-none rounded-xl px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all">
                            </div>
                            <button onclick="loadBills()" class="px-6 py-2.5 btn-ios rounded-xl text-sm font-medium text-white">
                                æŸ¥è¯¢
                            </button>
                        </div>
                    </div>

                    <!-- è´¦å•è¡¨æ ¼ -->
                    <div class="glass-light rounded-2xl overflow-hidden fade-in">
                        <div class="px-6 py-4 border-b ios-separator flex items-center justify-between">
                            <div class="flex items-center gap-4">
                                <h3 class="text-xs text-text-muted uppercase tracking-wide">è´¦å•æµæ°´</h3>
                                <span id="bill-summary" class="text-xs text-text-muted"></span>
                            </div>
                            <!-- åˆ†é¡µæ§ä»¶ -->
                            <div id="bills-pagination" class="hidden flex items-center gap-2">
                                <button onclick="billsPrevPage()" id="bills-prev-btn" class="px-3 py-1.5 bg-ios-elevated hover:bg-ios-surface rounded-lg text-xs font-medium disabled:opacity-40 disabled:cursor-not-allowed transition-all" disabled>
                                    ä¸Šä¸€é¡µ
                                </button>
                                <span id="bills-page-info" class="text-xs text-text-muted px-2">ç¬¬ 1 é¡µ</span>
                                <button onclick="billsNextPage()" id="bills-next-btn" class="px-3 py-1.5 bg-ios-elevated hover:bg-ios-surface rounded-lg text-xs font-medium disabled:opacity-40 disabled:cursor-not-allowed transition-all" disabled>
                                    ä¸‹ä¸€é¡µ
                                </button>
                            </div>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="text-xs text-text-muted">
                                    <tr class="border-b ios-separator">
                                        <th class="text-left px-6 py-3.5 font-medium">æ—¶é—´</th>
                                        <th class="text-left px-6 py-3.5 font-medium">ç±»å‹</th>
                                        <th class="text-left px-6 py-3.5 font-medium">å­ç±»å‹</th>
                                        <th class="text-center px-6 py-3.5 font-medium">T/M</th>
                                        <th class="text-left px-6 py-3.5 font-medium">åˆçº¦</th>
                                        <th class="text-right px-6 py-3.5 font-medium">æ”¶ç›Š/æ”¯å‡º</th>
                                        <th class="text-right px-6 py-3.5 font-medium">æ‰‹ç»­è´¹</th>
                                        <th class="text-right px-6 py-3.5 font-medium">ä½™é¢å˜åŠ¨</th>
                                        <th class="text-right px-6 py-3.5 font-medium">è´¦æˆ·ä½™é¢</th>
                                    </tr>
                                </thead>
                                <tbody id="bills-table" class="divide-y divide-ios-separator">
                                    <!-- åŠ¨æ€ç”Ÿæˆ -->
                                </tbody>
                            </table>
                        </div>
                        <div id="no-bills" class="hidden px-6 py-16 text-center text-text-muted text-sm">
                            <div class="text-5xl mb-4 opacity-40">ğŸ“‘</div>
                            <div class="text-base mb-1">æš‚æ— è´¦å•è®°å½•</div>
                            <div class="text-xs text-text-muted/60">é€‰æ‹©æ—¶é—´èŒƒå›´æŸ¥è¯¢è´¦å•æµæ°´</div>
                        </div>
                        <div id="bills-loading" class="hidden px-6 py-16 text-center text-text-muted text-sm">
                            <div class="inline-block w-5 h-5 border-2 border-accent border-t-transparent rounded-full animate-spin mb-3"></div>
                            <div>åŠ è½½ä¸­...</div>
                        </div>
                    </div>
                </div>

                <!-- å†å²ä»“ä½è§†å›¾ -->
                <div id="view-position-history" class="hidden space-y-5">
                    <!-- ç­›é€‰æ¡ä»¶ -->
                    <div class="glass-light rounded-2xl p-5 fade-in">
                        <div class="flex items-end gap-4 flex-wrap">
                            <div>
                                <label class="text-xs text-text-muted block mb-2">å¼€å§‹æ—¶é—´</label>
                                <input type="datetime-local" id="pos-history-start" class="bg-ios-elevated border-none rounded-xl px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all">
                            </div>
                            <div>
                                <label class="text-xs text-text-muted block mb-2">ç»“æŸæ—¶é—´</label>
                                <input type="datetime-local" id="pos-history-end" class="bg-ios-elevated border-none rounded-xl px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all">
                            </div>
                            <div>
                                <label class="text-xs text-text-muted block mb-2">åˆçº¦</label>
                                <input type="text" id="pos-history-inst" placeholder="å¦‚ BTC-USDT-SWAP" class="bg-ios-elevated border-none rounded-xl px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all w-48">
                            </div>
                            <div>
                                <label class="text-xs text-text-muted block mb-2">æ–¹å‘</label>
                                <select id="pos-history-side" class="bg-ios-elevated border-none rounded-xl px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all min-w-[100px]">
                                    <option value="">å…¨éƒ¨</option>
                                    <option value="long">å¤š</option>
                                    <option value="short">ç©º</option>
                                </select>
                            </div>
                            <button onclick="loadPositionHistory()" class="px-6 py-2.5 btn-ios rounded-xl text-sm font-medium text-white">
                                æŸ¥è¯¢
                            </button>
                        </div>
                    </div>

                    <!-- ä»“ä½å¡ç‰‡å®¹å™¨ -->
                    <div class="glass-light rounded-2xl overflow-hidden fade-in">
                        <div class="px-6 py-4 border-b ios-separator flex items-center justify-between">
                            <h3 class="text-xs text-text-muted uppercase tracking-wide">å†å²ä»“ä½</h3>
                            <!-- åˆ†é¡µæ§ä»¶ -->
                            <div id="pos-history-pagination" class="hidden flex items-center gap-2">
                                <button onclick="posHistoryPrevPage()" id="pos-history-prev-btn" class="px-3 py-1.5 bg-ios-elevated hover:bg-ios-surface rounded-lg text-xs font-medium disabled:opacity-40 disabled:cursor-not-allowed transition-all" disabled>
                                    ä¸Šä¸€é¡µ
                                </button>
                                <span id="pos-history-page-info" class="text-xs text-text-muted px-2">ç¬¬ 1 é¡µ</span>
                                <button onclick="posHistoryNextPage()" id="pos-history-next-btn" class="px-3 py-1.5 bg-ios-elevated hover:bg-ios-surface rounded-lg text-xs font-medium disabled:opacity-40 disabled:cursor-not-allowed transition-all" disabled>
                                    ä¸‹ä¸€é¡µ
                                </button>
                            </div>
                        </div>
                        <div id="pos-history-container" class="p-4 grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4">
                            <!-- åŠ¨æ€ç”Ÿæˆå¡ç‰‡ -->
                        </div>
                        <div id="no-pos-history" class="hidden px-6 py-16 text-center text-text-muted text-sm">
                            <div class="text-5xl mb-4 opacity-40">ğŸ“œ</div>
                            <div class="text-base mb-1">æš‚æ— å†å²ä»“ä½</div>
                            <div class="text-xs text-text-muted/60">é€‰æ‹©æ—¶é—´èŒƒå›´æŸ¥è¯¢å·²å¹³ä»“è®°å½•</div>
                        </div>
                        <div id="pos-history-loading" class="hidden px-6 py-16 text-center text-text-muted text-sm">
                            <div class="inline-block w-5 h-5 border-2 border-accent border-t-transparent rounded-full animate-spin mb-3"></div>
                            <div>åŠ è½½ä¸­...</div>
                        </div>
                    </div>
                </div>

                <!-- èµ„äº§æ›²çº¿è§†å›¾ -->
                <div id="view-equity-curve" class="hidden space-y-5">
                    <!-- ç­›é€‰æ¡ä»¶ -->
                    <div class="glass-light rounded-2xl p-5 fade-in">
                        <div class="flex items-end gap-4 flex-wrap">
                            <div>
                                <label class="text-xs text-text-muted block mb-2">æ—¶é—´èŒƒå›´</label>
                                <select id="equity-days" class="bg-ios-elevated border-none rounded-xl px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all min-w-[120px]">
                                    <option value="7">æœ€è¿‘ 7 å¤©</option>
                                    <option value="14">æœ€è¿‘ 14 å¤©</option>
                                    <option value="30" selected>æœ€è¿‘ 30 å¤©</option>
                                    <option value="60">æœ€è¿‘ 60 å¤©</option>
                                    <option value="90">æœ€è¿‘ 90 å¤©</option>
                                </select>
                            </div>
                            <div>
                                <label class="text-xs text-text-muted block mb-2">æ•°æ®ç²’åº¦</label>
                                <select id="equity-interval" class="bg-ios-elevated border-none rounded-xl px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all min-w-[120px]">
                                    <option value="raw">åŸå§‹æ•°æ®</option>
                                    <option value="hourly">æŒ‰å°æ—¶</option>
                                    <option value="daily">æŒ‰å¤©</option>
                                </select>
                            </div>
                            <button onclick="loadEquityCurve()" class="px-6 py-2.5 btn-ios rounded-xl text-sm font-medium text-white">
                                æŸ¥è¯¢
                            </button>
                        </div>
                    </div>

                    <!-- æ±‡æ€»å¡ç‰‡ -->
                    <div class="grid grid-cols-4 gap-4">
                        <div class="glass-light rounded-2xl p-5 fade-in hover:bg-glass-hover transition-all">
                            <div class="flex items-center gap-2 mb-2">
                                <span class="text-lg">ğŸ“…</span>
                                <span class="text-xs text-text-muted">èµ·å§‹ä½™é¢</span>
                            </div>
                            <div id="equity-start" class="text-xl font-mono font-semibold">--</div>
                        </div>
                        <div class="glass-light rounded-2xl p-5 fade-in hover:bg-glass-hover transition-all">
                            <div class="flex items-center gap-2 mb-2">
                                <span class="text-lg">ğŸ’°</span>
                                <span class="text-xs text-text-muted">æœ€æ–°ä½™é¢</span>
                            </div>
                            <div id="equity-end" class="text-xl font-mono font-semibold">--</div>
                        </div>
                        <div class="glass-light rounded-2xl p-5 fade-in hover:bg-glass-hover transition-all">
                            <div class="flex items-center gap-2 mb-2">
                                <span class="text-lg" id="equity-change-icon">ğŸ“Š</span>
                                <span class="text-xs text-text-muted">ç›ˆäº</span>
                            </div>
                            <div id="equity-change" class="text-xl font-mono font-semibold">--</div>
                        </div>
                        <div class="glass-light rounded-2xl p-5 fade-in hover:bg-glass-hover transition-all">
                            <div class="flex items-center gap-2 mb-2">
                                <span class="text-lg">ğŸ“</span>
                                <span class="text-xs text-text-muted">æ•°æ®ç‚¹</span>
                            </div>
                            <div id="equity-points" class="text-xl font-mono font-semibold text-text-secondary">--</div>
                        </div>
                    </div>

                    <!-- å›¾è¡¨ -->
                    <div class="glass-light rounded-2xl p-6 fade-in">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-xs text-text-muted uppercase tracking-wide">èµ„äº§æ›²çº¿ (USDT)</h3>
                        </div>
                        <div class="relative" style="height: 400px;">
                            <canvas id="equity-chart"></canvas>
                        </div>
                        <div id="no-equity-data" class="hidden absolute inset-0 flex items-center justify-center text-text-muted text-sm">
                            <div class="text-center">
                                <div class="text-5xl mb-4 opacity-40">ğŸ“ˆ</div>
                                <div class="text-base mb-1">æš‚æ— æ•°æ®</div>
                                <div class="text-xs text-text-muted/60">é€‰æ‹©è´¦æˆ·å’Œæ—¶é—´èŒƒå›´æŸ¥è¯¢èµ„äº§æ›²çº¿</div>
                            </div>
                        </div>
                        <div id="equity-loading" class="hidden absolute inset-0 flex items-center justify-center">
                            <div class="text-center text-text-muted text-sm">
                                <div class="inline-block w-5 h-5 border-2 border-accent border-t-transparent rounded-full animate-spin mb-3"></div>
                                <div>åŠ è½½ä¸­...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- è¯¦æƒ…å¼¹çª— -->
    <div id="detail-modal-overlay" class="modal-overlay" onclick="closeDetailModal()"></div>
    <div id="detail-modal" class="modal-container">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="detail-modal-title" class="text-base font-semibold text-text-primary">Detail</h3>
                <button class="modal-close" onclick="closeDetailModal()">
                    <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                        <path d="M1 1L11 11M1 11L11 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
            <div id="detail-modal-body" class="modal-body">
                <!-- åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
